<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
    layout:decorate="~{layout/default}">

<th:block layout:fragment="css">
    <link rel="stylesheet" href="/css/layout-content/admin/access-mng.css">
</th:block>
<th:block layout:fragment="script">
    <script src="/js/layout-content/admin/access-mng.js"></script>
</th:block>
<th:block layout:fragment="title">
    <title>PLICE ㅣ 접속 관리</title>
</th:block>

<div layout:fragment="content">
    <div class="top-space"></div>
    <div class="modal-background"></div>

    <div class="alert-window block-cancel-alert">
        <div class="info">
            <div class="text">차단을 해제하겠습니까?</div>
            <div class="data"></div>
        </div>
        <button class="cancel" onclick="hideAlert(this)">취소</button>
        <button class="okay" onclick="memberBlockCancel()">확인</button>
    </div>

    <div class="content-wrapper">

        <div th:replace="/layout/fragments/admin-nav :: admin-nav"></div>

        <div class="right-side">
            <div class="head" id="page-title" data-value="접속 관리">ㅣ 접속 관리</div>

            <div class="body">

                <div class="body-head">
                    <div class="sub-head">
                        <div class="text access-log-title active-text">엑세스 로그</div>
                        <div class="text member-blacklist-title">회원 차단 목록</div>
                        <div class="text ip-blacklist-title">IP 차단 목록</div>
                    </div>
                    <div class="search-wrapper">
                        <form class="search">
                            <div class="input-wrapper">
                                <select class="search-by" name="search-by">
                                    <option value="blacklistId">차단 관리 ID</option>
                                    <option value="memberId">회원 관리 ID</option>
                                    <option value="regDate">등록 일자</option>
                                    <option value="expDate">만료 일자</option>
                                </select>
                                <input class="search-input" type="text">
                                <img class="reset" src="/img/icon/x-circle.svg">
                                <img class="icon" src="/img/icon/search-icon.svg">
                            </div>
                        </form>
                    </div>
                </div>


                <div class="contents access-log-box">
                    <div class="top">
                        <div class="access-log-id">엑세스 로그 관리 ID</div>
                        <div class="member-id">회원 관리 ID</div>
                        <div class="ip">IP</div>
                        <div class="uri">접속 페이지</div>
                        <div class="reg-date">등록 일자</div>
                    </div>
                    <div class="access-log" th:each="access : ${accessList}" th:id="${access.id}">
                        <div class="access-log-id" th:text="${access.id}"></div>
                        <div class="member-id" th:text="${access.member.id}"></div>
                        <div class="ip" th:text="${access.ip}"></div>
                        <div class="uri" th:text="${access.uri}"></div>
                        <div class="reg-date" th:text="${#temporals.format(access.regDate, 'yyyy년 MM월 dd일 HH:mm:ss')}">
                        </div>
                    </div>

                    <div class="pagination-wrapper">
                        <span class="pagination"
                            th:with="start=${T(java.lang.Math).floor(accessList.number/10)*10 + 1}, last=(${accessList.totalPages})">

                            <a th:class="${accessList.first} ? 'disable'" th:href="@{/admin/access-mng(page=${accessList.number})}">
                                <img class="controller-btn-left" src="/img/icon/btn_left.png">
                            </a>

                            <a th:href="@{/inquire(page=1)}"
                                th:if="${accessList.totalPages < 4 ? false :accessList.number > 1}" th:text="1"
                                aria-label="First">
                            </a>

                            <span th:if="${accessList.totalPages < 4 ? false :accessList.number > 1}">...</span>

                            <a th:each="page: ${#numbers.sequence(start, last)}"
                                th:if="${accessList.first ? (page == 0 ? false : page < accessList.number + 4) :
                                        (accessList.last ? page > accessList.number - 2 : (page < accessList.number + 3) && (page > accessList.number - 1))}"
                                th:class="${page == accessList.number + 1} ? 'index-active'" th:text="${page}"
                                th:href="@{/inquire(page=${page})}">
                            </a>

                            <span
                                th:if="${accessList.totalPages < 4 ? false :accessList.number < accessList.totalPages - 2}">...</span>

                            <a th:href="@{/inquire(page=${accessList.totalPages})}"
                                th:if="${accessList.totalPages < 4 ? false :accessList.number < accessList.totalPages - 2}"
                                th:text="${accessList.totalPages}" aria-label="Last">
                            </a>

                            <a th:class="${accessList.last} ? 'disable'"
                                th:href="@{/inquire(page=${accessList.number +2})}">
                                <img class="controller-btn-right" src="/img/icon/btn_right.png">
                            </a>

                        </span>
                    </div>
                </div>

                <div class="contents member-blacklist-box">
                    <div class="top">
                        <div class="blacklist-id">차단 관리 ID</div>
                        <div class="member-id">회원 관리 ID</div>
                        <div class="reason">차단 사유</div>
                        <div class="reg-date">등록 일자</div>
                        <div class="exp-date">만료 일자</div>
                    </div>
                    <div class="member-blacklist" th:each="blacklist : ${blacklists}" th:id="${blacklist.id}"
                        th:if="${blacklist.ip} == null">
                        <div class="blacklist-id" th:text="${blacklist.id}"></div>
                        <div class="member-id" th:text="${blacklist.member.id}"></div>
                        <div class="reason" th:text="${blacklist.reason}"></div>
                        <div class="reg-date" th:text="${#dates.format(blacklist.regDate, 'yyyy년 MM월 dd일 HH:mm:ss')}">
                        </div>
                        <div class="exp-date" th:text="${#dates.format(blacklist.expDate, 'yyyy년 MM월 dd일 HH:mm:ss')}">
                        </div>
                        <a class="btn block-cancel-btn">차단 해제</a>
                    </div>

                    <div class="inquire-controller">
                        <span class="controller"
                            th:with="start=${T(java.lang.Math).floor(inquires.number/10)*10 + 1}, last=(${inquires.totalPages})">

                            <a th:class="${inquires.first} ? 'disable'" th:href="@{/inquire(page=${inquires.number})}">
                                <img class="controller-btn-left" src="/img/icon/btn_pagination_prev@2x.png">
                            </a>

                            <a th:href="@{/inquire(page=1)}"
                                th:if="${inquires.totalPages < 4 ? false :inquires.number > 1}" th:text="1"
                                aria-label="First">
                            </a>

                            <span th:if="${inquires.totalPages < 4 ? false :inquires.number > 1}">...</span>

                            <a th:each="page: ${#numbers.sequence(start, last)}"
                                th:if="${inquires.first ? (page == 0 ? false : page < inquires.number + 4) :
                (inquires.last ? page > inquires.number - 2 : (page < inquires.number + 3) && (page > inquires.number - 1))}"
                                th:class="${page == inquires.number + 1} ? 'index-active'" th:text="${page}"
                                th:href="@{/inquire(page=${page})}">
                            </a>

                            <span
                                th:if="${inquires.totalPages < 4 ? false :inquires.number < inquires.totalPages - 2}">...</span>

                            <a th:href="@{/inquire(page=${inquires.totalPages})}"
                                th:if="${inquires.totalPages < 4 ? false :inquires.number < inquires.totalPages - 2}"
                                th:text="${inquires.totalPages}" aria-label="Last">
                            </a>

                            <a th:class="${inquires.last} ? 'disable'"
                                th:href="@{/inquire(page=${inquires.number +2})}">
                                <img class="controller-btn-right" src="/img/icon/btn_pagination_next@2x.png">
                            </a>

                        </span>
                    </div>
                </div>

                <div class="contents ip-blacklist-box">
                    <div class="top">
                        <div class="blacklist-id">차단 관리 ID</div>
                        <div class="ip">IP</div>
                        <div class="reason">차단 사유</div>
                        <div class="reg-date">등록 일자</div>
                        <div class="exp-date">만료 일자</div>
                    </div>
                    <div class="ip-blacklist" th:each="blacklist : ${blacklists}" th:id="${blacklist.id}"
                        th:if="${blacklist.member} == null">
                        <div class="blacklist-id" th:text="${blacklist.id}"></div>
                        <div class="ip" th:text="${blacklist.ip}"></div>
                        <div class="reason" th:text="${blacklist.reason}"></div>
                        <div class="reg-date" th:text="${#dates.format(blacklist.regDate, 'yyyy년 MM월 dd일 HH:mm:ss')}">
                        </div>
                        <div class="exp-date" th:text="${#dates.format(blacklist.expDate, 'yyyy년 MM월 dd일 HH:mm:ss')}">
                        </div>
                        <a class="btn block-cancel-btn">차단 해제</a>
                    </div>

                    <div class="inquire-controller">
                        <span class="controller"
                            th:with="start=${T(java.lang.Math).floor(inquires.number/10)*10 + 1}, last=(${inquires.totalPages})">

                            <a th:class="${inquires.first} ? 'disable'" th:href="@{/inquire(page=${inquires.number})}">
                                <img class="controller-btn-left" src="/img/icon/btn_pagination_prev@2x.png">
                            </a>

                            <a th:href="@{/inquire(page=1)}"
                                th:if="${inquires.totalPages < 4 ? false :inquires.number > 1}" th:text="1"
                                aria-label="First">
                            </a>

                            <span th:if="${inquires.totalPages < 4 ? false :inquires.number > 1}">...</span>

                            <a th:each="page: ${#numbers.sequence(start, last)}"
                                th:if="${inquires.first ? (page == 0 ? false : page < inquires.number + 4) :
                (inquires.last ? page > inquires.number - 2 : (page < inquires.number + 3) && (page > inquires.number - 1))}"
                                th:class="${page == inquires.number + 1} ? 'index-active'" th:text="${page}"
                                th:href="@{/inquire(page=${page})}">
                            </a>

                            <span
                                th:if="${inquires.totalPages < 4 ? false :inquires.number < inquires.totalPages - 2}">...</span>

                            <a th:href="@{/inquire(page=${inquires.totalPages})}"
                                th:if="${inquires.totalPages < 4 ? false :inquires.number < inquires.totalPages - 2}"
                                th:text="${inquires.totalPages}" aria-label="Last">
                            </a>

                            <a th:class="${inquires.last} ? 'disable'"
                                th:href="@{/inquire(page=${inquires.number +2})}">
                                <img class="controller-btn-right" src="/img/icon/btn_pagination_next@2x.png">
                            </a>

                        </span>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>


</html>